<html>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" type="text/css" href="node_modules/jquery-datetimepicker/jquery.datetimepicker.css" >
<script src="node_modules/jquery-datetimepicker/jquery.js"></script>
<script src="node_modules/jquery-datetimepicker/build/jquery.datetimepicker.full.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<head>


<style>
/* width */
/* width */
::-webkit-scrollbar {
  width: 10px;
}
/* Track */
::-webkit-scrollbar-track {
  background: #f1f1f1; 
}
 
/* Handle */
::-webkit-scrollbar-thumb {
  background: #888; 
}
/* Handle on hover */
::-webkit-scrollbar-thumb:hover {
  background: #555; 
}
.center {
  margin: auto;
  width:50%;
  zoom: 2.25;
}
input[type=text] {
  padding:10px;
  border:10;
  box-shadow:0 0 15px 4px rgba(0,0,0,0.06);
  width: 320px;
  border-color: #007fff;
}
/* CSS */
.button-9 {
  appearance: button;
  backface-visibility: hidden;
  background-color: #007fff;
  border-radius: 6px;
  border-width: 0;
  box-shadow: rgba(50, 50, 93, .1) 0 0 0 1px inset,rgba(50, 50, 93, .1) 0 2px 5px 0,rgba(0, 0, 0, .07) 0 1px 1px 0;
  box-sizing: border-box;
  color: #fff;
  cursor: pointer;
  font-family: -apple-system,system-ui,"Segoe UI",Roboto,"Helvetica Neue",Ubuntu,sans-serif;
  font-size: 100%;
  height: 55px;
  line-height: 1.15;
  margin: 12px 0 0;
  outline: none;
  overflow: hidden;
  padding: 0 25px;
  position: relative;
  text-align: center;
  text-transform: none;
  transform: translateZ(0);
  transition: all .2s,box-shadow .08s ease-in;
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  width: 320px;
}
.button-9:disabled {
  cursor: default;
}
.button-9:focus {
  box-shadow: rgba(50, 50, 93, .1) 0 0 0 1px inset, rgba(50, 50, 93, .2) 0 6px 15px 0, rgba(0, 0, 0, .1) 0 2px 2px 0, rgba(50, 151, 211, .3) 0 0 0 4px;
}
.shift_down {
  padding-top: 10px;
}
* {
/*   box-shadow: 0 0 0 1px red; */
  box-sizing: border-box;
}
/* Add a black background color to the top navigation */
.topnav {
  background-color: #333;
  overflow: hidden;
  
}
/* Style the links inside the navigation bar */
.topnav a {
  float: left;
  color: #f2f2f2;
  text-align: center;
  padding: 28px 320px;
  text-decoration: none;
  font-size: 17px;
  font-family: -apple-system,system-ui,"Segoe UI",Roboto,"Helvetica Neue",Ubuntu,sans-serif;
}
/* Change the color of links on hover */
.topnav a:hover {
  background-color: #ddd;
  color: black;
}
/* Add a color to the active/current link */
.topnav a.active {
  background-color: #007fff;
  color: white;
}
</style>
</head>

<div class="topnav">
  <a class="active" href="#home">Schedule</a>
  <a href="#cancel">Cancel</a>
</div>

<form action="/appointment" method="post">
<body style="background-color:black;">
    <div class="center" >       
        <div class = "shift_down">
        <div><h3>
            <label for="curr_date"></label>
            <input type="text" id="curr_date" placeholder="" name="curr_date" readonly />
            <span class="validity"></span>
          </div> </h3> 
        <h2><input id="input" type="text" ></h2>
        </div> 
        <div><h3>
          <label for="user_name"></label>
          <input type="text" id="user_name" placeholder="Name:" name="user_name" required />
          <span class="validity"></span>
        </div> </h3> 
        <div><h3>
          <label for="email_input"></label>
          <input type="text" id="email_input" placeholder="Email:" name="email_input" required />
          <span class="validity"></span>
        </div> </h3>

        <input type="submit" class="button-9" value="Book Time"></input>
  </div>
</body>
</form>
</html>

<p hidden>
  <%moviesList.forEach(movie => {%>
    <%=arr.push(movie.title)%>
  <%})%>
</p>

  
<script>
function hideIt(){
    $( "#input" ).datetimepicker( "destroy" );
    $( "#input" ).hide();
}
function showIt(x){
    $( "#input" ).show();
      if (x == " Aug 04") {
      $( "#input" ).datetimepicker({
        theme: "dark",
        minDate:new Date(),
        MaxDate: "+1Y",
        datepicker: true,
        timepicker: true,
        inline:true,
        format: 'M-d-Y',
        lang:'ru',
        allowTimes:[
        '8:00', '11:00', '14:00',
        '17:00'
      ],
        disabledDates: ['Aug.15.2022'],
        formatDate: 'M.d.Y',
        onSelectDate: re_run,
        onSelectTime: re_run
      });
    }
    else if (x == " Aug 08") {
      $( "#input" ).datetimepicker({
        theme: "dark",
        minDate:new Date(),
        MaxDate: "+1Y",
        datepicker: true,
        timepicker: true,
        inline:true,
        format: 'M-d-Y',
        lang:'ru',
        allowTimes:[
        '8:00', '14:00',
        '17:00'
      ],
        disabledDates: ['Aug.15.2022'],
        formatDate: 'M.d.Y',
        onSelectDate: re_run,
        onSelectTime: re_run
      });
    }
    else{
      $( "#input" ).datetimepicker({
        theme: "dark",
        minDate:new Date(),
        MaxDate: "+1Y",
        datepicker: true,
        timepicker: true,
        inline:true,
        format: 'M-d-Y',
        lang:'ru',
        allowTimes:[
        '8:00', '11:00', '14:00',
        '17:00'
      ],
        disabledDates: ['Aug.15.2022'],
        formatDate: 'M.d.Y',
        onSelectDate: re_run,
        onSelectTime: re_run
      });
    }
}
$('#input').datetimepicker({
  theme: "dark",
  minDate: new Date(),
  datepicker: true,
  timepicker: true,
  inline:true,
  format: 'M-d-Y',
  lang:'ru',
  allowTimes:[
  '8:00', '11:00', '14:00',
  '17:00'
 ],
  disabledDates: ['Aug.15.2022'],
  formatDate: 'M.d.Y',
  onSelectDate: re_run,
  onSelectTime: re_run
});

function re_run() {

  var test = "<%= arr %>";
  alert(test);

  let date_val = $('#input').datetimepicker('getValue');
  let val = date_val.toString().slice(3,15)
  let val_2 = date_val.toString().slice(16, 21)
  let val_3 = date_val.toString().slice(16, 18)
  if (parseInt(val_3) > 12){
      val_3 = (parseInt(val_3) - 12).toString();
      val_2 = val_3 + val_2.slice(2,5) + " PM"
  }
  else{
    val_2 += " AM"
  }
  document.getElementById("curr_date").value = val + ", " + val_2;
  javascript:hideIt()
  console.log(date_val.toString().slice(3,10));
  javascript:showIt(val.slice(0,7))
};
</script>
